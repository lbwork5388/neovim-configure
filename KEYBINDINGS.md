# Neovim 快捷键速查表

> **注意**: `<leader>` 键是 **空格键** (Space)

## 🔍 Telescope 模糊查找器

### 文件查找

| 快捷键 | 说明 | 实际按键 |
|--------|------|---------|
| `<leader>ff` | 查找文件 | **空格 + f + f** |
| `<leader>fg` | 全局搜索内容 | **空格 + f + g** |
| `<leader>fb` | 查找已打开的缓冲区 | **空格 + f + b** |
| `<leader>fr` | 最近打开的文件 | **空格 + f + r** |
| `<leader>fh` | 查找帮助文档 | **空格 + f + h** |
| `<leader>fc` | 搜索光标下的词 | **空格 + f + c** |

### Git 查找

| 快捷键 | 说明 | 实际按键 |
|--------|------|---------|
| `<leader>gf` | 查找 Git 文件 | **空格 + g + f** |
| `<leader>gc` | 查找 Git 提交 | **空格 + g + c** |
| `<leader>gs` | Git 状态 | **空格 + g + s** |

### LSP 查找

| 快捷键 | 说明 | 实际按键 |
|--------|------|---------|
| `<leader>fs` | 文档符号 | **空格 + f + s** |
| `<leader>fw` | 工作区符号 | **空格 + f + w** |

### Telescope 窗口内操作

在 Telescope 弹出窗口中：

| 按键 | 说明 |
|------|------|
| `<C-n>` / `<Down>` | 下一个结果 |
| `<C-p>` / `<Up>` | 上一个结果 |
| `<CR>` (回车) | 选择并打开 |
| `<C-x>` | 水平分割打开 |
| `<C-v>` | 垂直分割打开 |
| `<C-t>` | 新标签页打开 |
| `<C-u>` / `<C-d>` | 预览窗口上下滚动 |
| `<Esc>` / `<C-c>` | 关闭 |

## 🔀 Git 集成 (gitsigns)

### Git 导航

| 快捷键 | 说明 |
|--------|------|
| `]c` | 跳转到下一个修改 |
| `[c` | 跳转到上一个修改 |

### Git 操作

| 快捷键 | 说明 | 实际按键 |
|--------|------|---------|
| `<leader>hp` | 预览当前修改 | **空格 + h + p** |
| `<leader>hr` | 撤销当前修改 | **空格 + h + r** |
| `<leader>hs` | 暂存当前修改 | **空格 + h + s** |
| `<leader>hS` | 暂存整个文件 | **空格 + h + S** |
| `<leader>hu` | 撤销暂存 | **空格 + h + u** |
| `<leader>hR` | 重置整个文件 | **空格 + h + R** |
| `<leader>hb` | 查看 blame | **空格 + h + b** |
| `<leader>hd` | 查看 diff | **空格 + h + d** |
| `<leader>tb` | 切换行 blame 显示 | **空格 + t + b** |
| `<leader>td` | 切换显示删除的行 | **空格 + t + d** |

### Git 可视标记

左侧栏的符号含义：
- `│` - 新增或修改的行
- `_` - 删除的行
- `~` - 修改并删除的行
- `┆` - 未跟踪的行

## 🔑 Which-Key 快捷键提示

### 自动提示

当你按下快捷键前缀后，等待 300ms，会自动显示可用的后续按键。

**示例**：
1. 按 `空格` 然后等待 → 显示所有可用的 leader 快捷键
2. 按 `空格 + f` 然后等待 → 显示所有查找相关的快捷键
3. 按 `空格 + g` 然后等待 → 显示所有 Git 相关的快捷键

### 快捷键分组

| 前缀 | 说明 |
|------|------|
| `空格 + f` | 查找相关（文件、内容、符号等）|
| `空格 + g` | Git 相关（文件、提交、状态等）|
| `空格 + h` | Git 操作（预览、撤销、暂存等）|
| `空格 + t` | 切换开关（blame、删除显示等）|
| `空格 + c` | 代码操作 |
| `空格 + r` | 重命名 |
| `空格 + e` | 文件树 |

**好处**：不记得快捷键？按下前缀等一下就能看到！

## 💬 Comment 快速注释

### 基本操作

| 快捷键 | 模式 | 说明 |
|--------|------|------|
| `gcc` | 普通模式 | 注释/取消注释当前行 |
| `gc` | 可视模式 | 注释/取消注释选中的行 |
| `gbc` | 普通模式 | 块注释当前行 |
| `gb` | 可视模式 | 块注释选中的内容 |

### 组合操作

在普通模式下，`gc` 后面可以接动作：

| 组合 | 说明 |
|------|------|
| `gcj` | 注释当前行和下一行 |
| `gc3j` | 注释当前行和下面 3 行 |
| `gcap` | 注释整个段落 |
| `gc$` | 从光标注释到行尾 |
| `gcG` | 从当前行注释到文件末尾 |

### 额外操作

| 快捷键 | 说明 |
|--------|------|
| `gcO` | 在上方添加注释行 |
| `gco` | 在下方添加注释行 |
| `gcA` | 在行尾添加注释 |

### 使用示例

```lua
-- 示例 1：注释当前行
local x = 10    ← 光标在这里，按 gcc
-- local x = 10  ← 变成注释了

-- 示例 2：注释多行
-- 可视模式选中几行，按 gc
```

## 🎨 Noice UI 增强

### 功能说明

Noice 会自动美化以下内容：
- ✅ 命令行（输入 `:` 后的界面）
- ✅ 搜索栏（输入 `/` 后的界面）
- ✅ 通知消息
- ✅ LSP 文档

**无需快捷键，自动生效！**

### 效果

- 输入 `:` → 显示弹出式命令行（更清晰）
- 输入 `/` → 显示美化的搜索界面
- 插件安装完成 → 右上角显示优雅的通知
- 按 `K` 查看文档 → 带边框的美化文档

## 🔗 自动括号配对 (autopairs)

### 自动行为

在插入模式下：

| 输入 | 结果 | 光标位置 |
|------|------|---------|
| `(` | `(|)` | 括号中间 |
| `{` | `{|}` | 括号中间 |
| `[` | `[|]` | 括号中间 |
| `"` | `"|"` | 引号中间 |
| `'` | `'|'` | 引号中间 |

**说明**：`|` 表示光标位置

### 智能跳过

当光标后面已经有右括号时：
- 输入 `)` → 直接跳过，不重复插入
- 输入 `}` → 直接跳过
- 输入 `]` → 直接跳过

### 自动删除

- 按 `Backspace` 删除左括号时，右括号也会被删除

### 快速包裹

- `Alt + e` - 快速用括号包裹选中的文本（高级功能）

## 🌳 文件树 (nvim-tree)

| 快捷键 | 说明 | 实际按键 |
|--------|------|---------|
| `<leader>e` | 打开/关闭文件树 | **空格 + e** |
| `<leader>ef` | 在文件树中定位当前文件 | **空格 + e + f** |
| `<leader>ec` | 折叠文件树 | **空格 + e + c** |

### 文件树内操作

在文件树窗口中（移动光标到文件树后）：

| 按键 | 说明 |
|------|------|
| `<CR>` (回车) | 打开文件/展开文件夹 |
| `a` | 新建文件/文件夹（末尾加 `/` 表示文件夹） |
| `d` | 删除文件/文件夹 |
| `r` | 重命名 |
| `x` | 剪切 |
| `c` | 复制 |
| `p` | 粘贴 |
| `y` | 复制文件名 |
| `Y` | 复制相对路径 |
| `gy` | 复制绝对路径 |
| `R` | 刷新文件树 |
| `H` | 显示/隐藏隐藏文件 |
| `q` | 关闭文件树 |

## 🔧 LSP 功能

### 代码导航

| 快捷键 | 说明 |
|--------|------|
| `gd` | 跳转到定义 |
| `gD` | 跳转到声明 |
| `gi` | 跳转到实现 |
| `gr` | 查看引用 |
| `K` | 显示文档/悬停信息 |
| `<C-k>` | 显示签名帮助 |

### 代码编辑

| 快捷键 | 说明 | 实际按键 |
|--------|------|---------|
| `<leader>rn` | 重命名符号 | **空格 + r + n** |
| `<leader>ca` | 代码操作（Code Action） | **空格 + c + a** |
| `<leader>d` | 显示诊断详情 | **空格 + d** |
| `[d` | 上一个诊断/错误 | **[ + d** |
| `]d` | 下一个诊断/错误 | **] + d** |

### 自动补全（插入模式）

| 快捷键 | 说明 |
|--------|------|
| `<Tab>` | 选择下一个补全项 |
| `<S-Tab>` | 选择上一个补全项 |
| `<CR>` (回车) | 确认选择 |
| `<C-Space>` | 手动触发补全 |
| `<C-e>` | 关闭补全菜单 |
| `<C-b>` / `<C-f>` | 向上/向下滚动文档 |

## 📦 插件管理

| 快捷键 | 说明 | 实际按键 |
|--------|------|---------|
| `<leader>l` | 打开 Lazy 插件管理器 | **空格 + l** |

### Lazy 插件管理器内

| 按键 | 说明 |
|------|------|
| `I` | 安装缺失的插件 |
| `U` | 更新插件 |
| `S` | 同步（安装+更新+清理） |
| `X` | 清理未使用的插件 |
| `q` | 关闭 |

## 🎨 Treesitter（语法高亮）

### 增量选择

| 快捷键 | 说明 |
|--------|------|
| `<CR>` (回车) | 开始选择/扩大选择 |
| `<BS>` (退格) | 缩小选择 |

## 📝 常用 Vim 命令

### 模式切换

| 按键 | 说明 |
|------|------|
| `i` | 进入插入模式（光标前） |
| `a` | 进入插入模式（光标后） |
| `o` | 下方新建行并进入插入模式 |
| `O` | 上方新建行并进入插入模式 |
| `<Esc>` | 返回普通模式 |
| `v` | 进入可视模式 |
| `V` | 进入可视行模式 |

### 保存和退出

| 命令 | 说明 |
|------|------|
| `:w` | 保存 |
| `:q` | 退出 |
| `:wq` | 保存并退出 |
| `:q!` | 强制退出（不保存） |

### 窗口管理

| 快捷键 | 说明 |
|--------|------|
| `<C-w>v` | 垂直分割窗口 |
| `<C-w>s` | 水平分割窗口 |
| `<C-w>h/j/k/l` | 在窗口间移动 |
| `<C-w>q` | 关闭当前窗口 |

## 🔍 管理命令

### Mason（LSP 管理）

```vim
:Mason          " 打开 Mason 管理界面
:MasonInstall   " 安装 LSP 服务器
:MasonLog       " 查看安装日志
```

### Treesitter

```vim
:TSInstall <language>    " 安装语言解析器
:TSUpdate               " 更新所有解析器
:TSInstallInfo          " 查看已安装的解析器
```

## 💡 使用提示

1. **打开文件树**: 在普通模式下，先按 **空格**，再按 **e**
2. **如果快捷键不工作**: 
   - 确保你在普通模式（按 `Esc` 返回普通模式）
   - 重启 Neovim: `:source ~/.config/nvim/init.lua`
3. **查看所有快捷键**: 将来可以安装 `which-key` 插件来显示快捷键提示
4. **窗口间切换**: 按 `Ctrl+w` 然后按方向键 `h/j/k/l`

## 🆘 故障排查

如果快捷键不工作：

```vim
" 在 Neovim 中检查 leader 键
:echo mapleader

" 应该显示一个空格，如果显示 undefined，说明 leader 键没设置
" 解决方法：重启 Neovim
```

